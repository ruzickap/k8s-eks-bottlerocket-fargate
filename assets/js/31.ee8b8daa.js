(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{319:function(a,t,s){"use strict";s.r(t);var e=s(8),n=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"drupal"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#drupal"}},[a._v("#")]),a._v(" Drupal")]),a._v(" "),t("p",[a._v("Few notes about Drupal installation with RDS + EFS.")]),a._v(" "),t("h2",{attrs:{id:"drupal-installation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#drupal-installation"}},[a._v("#")]),a._v(" Drupal installation")]),a._v(" "),t("p",[a._v("Get details about AWS environment where is the EKS cluster and store it into\nvariables:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("RDS_DB_USERNAME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"root"')]),a._v("\n")])])]),t("h3",{attrs:{id:"rds"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rds"}},[a._v("#")]),a._v(" RDS")]),a._v(" "),t("p",[a._v("Apply CloudFormation template to create Amazon RDS MySQL database.\nThe template below is inspired by: "),t("a",{attrs:{href:"https://github.com/aquasecurity/marketplaces/blob/master/aws/cloudformation/AquaRDS.yaml",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://github.com/aquasecurity/marketplaces/blob/master/aws/cloudformation/AquaRDS.yaml"),t("OutboundLink")],1)]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"tmp/'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${CLUSTER_FQDN}")]),a._v('/cf_rds.yml"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("EOF\nAWSTemplateFormatVersion: "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2010")]),a._v("-09-09\nDescription: This AWS CloudFormation template installs the AWS RDS MySQL database.\nParameters:\n  ClusterName:\n    Default: "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"kube1"')]),a._v("\n    Description: K8s Cluster name\n    Type: String\n  KmsKeyId:\n    Description: The ARN of the AWS Key Management Service "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("AWS KMS"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" master key that is used to encrypt the DB instance\n    Type: String\n  MultiAzDatabase:\n    Default: "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"false"')]),a._v("\n    Type: String\n    AllowedValues:\n      - "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"true"')]),a._v("\n      - "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"false"')]),a._v("\n    ConstraintDescription: Must be either "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v(" or false.\n  RdsMasterUsername:\n    Description: Enter the master username "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" the RDS instance.\n    Type: String\n    MinLength: "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"1"')]),a._v("\n    MaxLength: "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"63"')]),a._v("\n    AllowedPattern: "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"^[a-zA-Z0-9]*$"')]),a._v("\n    ConstraintDescription: "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("-\n      Must be "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" to "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("63")]),a._v(" characters long, begin with a letter, contain only\n      alphanumeric characters, and not be a reserved word by PostgreSQL engine.\n  RdsInstanceClass:\n    Type: String\n    Default: db.t2.medium\n    AllowedValues:\n      - db.t2.micro\n      - db.t2.small\n      - db.t2.medium\n      - db.t2.large\n      - db.t2.xlarge\n      - db.t2.2xlarge\n      - db.m4.large\n      - db.m4.xlarge\n      - db.m4.2xlarge\n      - db.m4.4xlarge\n      - db.m4.10xlarge\n      - db.m4.16xlarge\n      - db.r4.large\n      - db.r4.xlarge\n      - db.r4.2xlarge\n      - db.r4.4xlarge\n      - db.r4.8xlarge\n      - db.r4.16xlarge\n      - db.r3.large\n      - db.r3.2xlarge\n      - db.r3.4xlarge\n      - db.r3.8xlarge\n    ConstraintDescription: Must be a valid EC2 RDS instance "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("type")]),a._v("\n  RdsMasterPassword:\n    NoEcho: "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"true"')]),a._v("\n    Description: "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("-\n      Enter the master password "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" the RDS instance. This password must contain\n      "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8")]),a._v(" to "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("128")]),a._v(" characters and can be any printable ASCII character except @, /,\n      or "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('".\n    Type: String\n    MinLength: "')]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n    MaxLength: "')]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("128")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n    AllowedPattern: >-\n      ^'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("((")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("?")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v("["),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("9")]),a._v("]"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("?")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v("[a"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("z]"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("?")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v("[A"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("Z]"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("?")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v("["),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("9")]),a._v("]"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("?")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v("[a"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("z]"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("?")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v("["),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("!")]),a._v("@#$"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("%")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v("]"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("?")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v("["),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("9")]),a._v("]"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("?")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v("[A"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("Z]"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("?")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v("["),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("!")]),a._v("@#$"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("%")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v("]"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("?")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v("[a"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("z]"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("?")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v("[A"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("Z]"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("?")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v("["),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("!")]),a._v("@#$"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("%")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v("]"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("))")])]),a._v('.{8,128}$\n    ConstraintDescription: >-\n      Password must be at least 9 characters long and have 3 out of the\n      following: one number, one lower case, one upper case, or one special\n      character.\n  RdsStorage:\n    Default: "')]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("40")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n    Type: Number\n    MinValue: "')]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("40")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n    MaxValue: "')]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1024")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n    ConstraintDescription: Must be set to between 40 and 1024GB.\n  VpcIPCidr:\n    Description: "')]),a._v("Enter VPC CIDR that hosts the EKS cluster. Ex: "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("10.0")]),a._v(".0.0/16"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n    Type: String\nResources:\n  DBMonitoringRole:\n    Type: AWS::IAM::Role\n    Properties:\n      Path: "')]),a._v("/"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n      ManagedPolicyArns:\n        - arn:aws:iam::aws:policy/service-role/AmazonRDSEnhancedMonitoringRole\n      AssumeRolePolicyDocument:\n        Version: 2012-10-17\n        Statement:\n          - Effect: Allow\n            Principal:\n              Service:\n                - monitoring.rds.amazonaws.com\n            Action:\n              - sts:AssumeRole\n  RdsInstance:\n    Type: AWS::RDS::DBInstance\n    DependsOn:\n      - DbSecurityGroup\n      - RdsInstanceSubnetGroup\n    DeletionPolicy: Delete\n    Properties:\n      AllocatedStorage: !Ref RdsStorage\n      AutoMinorVersionUpgrade: "')]),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n      VPCSecurityGroups:\n        - !Ref DbSecurityGroup\n      DBName: !Sub "')]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${ClusterName}")]),a._v("db"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n      BackupRetentionPeriod: "')]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n      DBInstanceIdentifier: !Sub "')]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${ClusterName}")]),a._v("db"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n      DBInstanceClass: !Ref RdsInstanceClass\n      DBSubnetGroupName: !Ref RdsInstanceSubnetGroup\n      CopyTagsToSnapshot: true\n      EnableCloudwatchLogsExports:\n        - slowquery\n      EnableIAMDatabaseAuthentication: true\n      Engine: mysql\n      EngineVersion: 8.0.23\n      KmsKeyId: !Ref KmsKeyId\n      MasterUsername: !Ref RdsMasterUsername\n      MasterUserPassword: !Ref RdsMasterPassword\n      MonitoringInterval: 60\n      MonitoringRoleArn: !GetAtt DBMonitoringRole.Arn\n      MultiAZ: !Ref MultiAzDatabase\n      StorageEncrypted: true\n      # gp3 is not supported yet (2021-01-30)\n      StorageType: gp2\n  RdsInstanceSubnetGroup:\n    Type: "')]),a._v("AWS::RDS::DBSubnetGroup"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n    Properties:\n      DBSubnetGroupDescription: Source subnet\n      SubnetIds:\n      - Fn::Select:\n        - 0\n        - Fn::Split:\n          - "')]),a._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n          - Fn::ImportValue: !Sub "')]),a._v("eksctl-"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${ClusterName}")]),a._v("-cluster::SubnetsPrivate"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n      - Fn::Select:\n        - 1\n        - Fn::Split:\n          - "')]),a._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n          - Fn::ImportValue: !Sub "')]),a._v("eksctl-"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${ClusterName}")]),a._v("-cluster::SubnetsPrivate"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n  # Create DB Security Group\n  DbSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      GroupDescription: For RDS Instance\n      VpcId:\n        Fn::ImportValue:\n          Fn::Sub: "')]),a._v("eksctl-"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${ClusterName}")]),a._v("-cluster::VPC"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n  # Attach Security Group Rule\n  DbIngress1:\n    Type: AWS::EC2::SecurityGroupIngress\n    Properties:\n      GroupId: !Ref DbSecurityGroup\n      IpProtocol: tcp\n      FromPort: "')]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3306")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n      ToPort: "')]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3306")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n      CidrIp: !Ref "')]),a._v("VpcIPCidr"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\nOutputs:\n  RdsInstanceEndpoint:\n    Description: MySQL endpoint\n    Value: !GetAtt RdsInstance.Endpoint.Address\n    Export:\n      Name:\n        Fn::Sub: "')]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${AWS"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v("StackName}")]),a._v("-RdsInstanceEndpoint"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n  RdsInstancePort:\n    Description: MySQL port\n    Value: !GetAtt RdsInstance.Endpoint.Port\n    Export:\n      Name:\n        Fn::Sub: "')]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${AWS"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v("StackName}")]),a._v("-RdsInstancePort"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n  RdsInstanceUser:\n    Description: Username for the MySQL instance\n    Value: !Ref RdsMasterUsername\n    Export:\n      Name:\n        Fn::Sub: "')]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${AWS"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v("StackName}")]),a._v("-RdsInstanceUser"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n  RdsMasterPassword:\n    Description: Password for the MySQL instance\n    Value: !Ref RdsMasterPassword\n    Export:\n      Name:\n        Fn::Sub: "')]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${AWS"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v("StackName}")]),a._v("-RdsMasterPassword"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\nEOF\n\neval aws cloudformation deploy --capabilities CAPABILITY_NAMED_IAM --stack-name "')]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${CLUSTER_NAME}")]),a._v("-rds"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('" --parameter-overrides "')]),a._v("ClusterName"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${CLUSTER_NAME}")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("KmsKeyId")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${KMS_KEY_ID}")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("RdsMasterPassword")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${MY_PASSWORD}")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("RdsMasterUsername")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${RDS_DB_USERNAME}")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("VpcIPCidr")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${EKS_VPC_CIDR}")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('" --template-file "')]),a._v("tmp/"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${CLUSTER_FQDN}")]),a._v("/cf_rds.yml"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('" --tags "')]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${TAGS}")]),a._v('"\n\n'),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("RDS_DB_HOST")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),a._v("aws rds describe-db-instances "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--query")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"DBInstances[?DBInstanceIdentifier==\\'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("$"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("CLUSTER_NAME"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("db"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v('].[Endpoint.Address]"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--output")]),a._v(" text"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("RDS_DB_RESOURCE_ID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),a._v("aws rds describe-db-instances "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--query")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"DBInstances[?DBInstanceIdentifier==\\'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("$"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("CLUSTER_NAME"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("db"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v('].DbiResourceId"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--output")]),a._v(" text"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v("\n")])])]),t("p",[a._v("Initialize database:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("kubectl get pods mysql-client-drupal "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("||")]),a._v(" kubectl run "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--env")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("MYSQL_PWD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${MY_PASSWORD}")]),a._v('"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--image")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql:8.0 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--restart")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("Never mysql-client-drupal -- "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  mysql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-h")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${RDS_DB_HOST}")]),a._v('"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${RDS_DB_USERNAME}")]),a._v('"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\n    CREATE USER '),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("exporter"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("@"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("%"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v(" IDENTIFIED BY "),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${MY_PASSWORD}")]),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v(" WITH MAX_USER_CONNECTIONS 3;\n    CREATE USER "),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("drupal"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("@"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("%"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v(" IDENTIFIED BY "),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${MY_PASSWORD}")]),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v(";\n    CREATE USER "),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("drupal2"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("@"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("%"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v(" IDENTIFIED BY "),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${MY_PASSWORD}")]),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v(";\n    CREATE USER "),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("iamtest"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("@"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("%"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v(" IDENTIFIED WITH AWSAuthenticationPlugin AS "),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("RDS"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v(" REQUIRE SSL;\n    CREATE DATABASE drupal;\n    CREATE DATABASE drupal2;\n    CREATE DATABASE iamtest;\n    GRANT PROCESS, REPLICATION CLIENT, SELECT ON *.* TO "),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("exporter"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("@"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("%"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v(";\n    GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, INDEX, ALTER, CREATE TEMPORARY TABLES ON drupal.* TO "),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("drupal"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("@"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("%"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v(";\n    GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, INDEX, ALTER, CREATE TEMPORARY TABLES ON drupal2.* TO "),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("drupal2"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("@"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("%"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v(";\n    GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, INDEX, ALTER, CREATE TEMPORARY TABLES ON iamtest.* TO "),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("iamtest"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("@"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("%"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v(';\n  "')]),a._v("\n")])])]),t("h3",{attrs:{id:"prometheus-mysql-exporter"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#prometheus-mysql-exporter"}},[a._v("#")]),a._v(" Prometheus MySQL Exporter")]),a._v(" "),t("p",[a._v("Install "),t("a",{attrs:{href:"https://github.com/prometheus/mysqld_exporter",target:"_blank",rel:"noopener noreferrer"}},[a._v("Prometheus MySQL Exporter"),t("OutboundLink")],1),a._v("\nusing Helm Chart.")]),a._v(" "),t("p",[a._v("Install "),t("code",[a._v("prometheus-mysql-exporter")]),a._v(" "),t("a",{attrs:{href:"https://artifacthub.io/packages/helm/prometheus-community/prometheus-mysql-exporter",target:"_blank",rel:"noopener noreferrer"}},[a._v("helm chart"),t("OutboundLink")],1),a._v("\nand modify the\n"),t("a",{attrs:{href:"https://github.com/prometheus-community/helm-charts/blob/main/charts/prometheus-mysql-exporter/values.yaml",target:"_blank",rel:"noopener noreferrer"}},[a._v("default values"),t("OutboundLink")],1),a._v(".")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("helm upgrade "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--install")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--version")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.2")]),a._v(".1 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--namespace")]),a._v(" prometheus-mysql-exporter --create-namespace "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--values")]),a._v(" - prometheus-mysql-exporter prometheus-community/prometheus-mysql-exporter "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('EOF\nserviceMonitor:\n  enabled: true\nmysql:\n  host: "'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${RDS_DB_HOST}")]),a._v('"\n  pass: "'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${MY_PASSWORD}")]),a._v('"\n  user: "exporter"\nEOF')]),a._v("\n")])])]),t("h3",{attrs:{id:"phpmyadmin"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#phpmyadmin"}},[a._v("#")]),a._v(" phpMyAdmin")]),a._v(" "),t("p",[a._v("Install "),t("a",{attrs:{href:"https://www.phpmyadmin.net/",target:"_blank",rel:"noopener noreferrer"}},[a._v("phpMyAdmin"),t("OutboundLink")],1),a._v(" using Helm Chart.")]),a._v(" "),t("p",[a._v("Install "),t("code",[a._v("phpmyadmin")]),a._v(" "),t("a",{attrs:{href:"https://artifacthub.io/packages/helm/bitnami/phpmyadmin",target:"_blank",rel:"noopener noreferrer"}},[a._v("helm chart"),t("OutboundLink")],1),a._v("\nand modify the\n"),t("a",{attrs:{href:"https://github.com/bitnami/charts/blob/master/bitnami/phpmyadmin/values.yaml",target:"_blank",rel:"noopener noreferrer"}},[a._v("default values"),t("OutboundLink")],1),a._v(".")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("helm upgrade "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--install")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--version")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8.2")]),a._v(".11 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--namespace")]),a._v(" phpmyadmin --create-namespace "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--values")]),a._v(" - phpmyadmin bitnami/phpmyadmin "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("EOF\ningress:\n  enabled: true\n  hostname: phpmyadmin."),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${CLUSTER_FQDN}")]),a._v("\n  annotations:\n    nginx.ingress.kubernetes.io/auth-url: https://oauth2-proxy."),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${CLUSTER_FQDN}")]),a._v("/oauth2/auth\n    nginx.ingress.kubernetes.io/auth-signin: https://oauth2-proxy."),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${CLUSTER_FQDN}")]),a._v("/oauth2/start?rd=\\"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$scheme")]),a._v("://\\"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$host")]),a._v("\\"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$request_uri")]),a._v("\n  extraTls:\n  - hosts:\n      - phpmyadmin."),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${CLUSTER_FQDN}")]),a._v("\n    secretName: ingress-cert-"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${LETSENCRYPT_ENVIRONMENT}")]),a._v("\nmetrics:\n  enabled: true\n  serviceMonitor:\n    enabled: true\ndb:\n  allowArbitraryServer: false\n  host: "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${RDS_DB_HOST}")]),a._v("\n  enableSsl: true\n  ssl:\n    caCertificate: |-\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"https://s3.amazonaws.com/rds-downloads/rds-ca-2019-root.pem"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sed")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"s/^/      /"')]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v("\nEOF")]),a._v("\n")])])]),t("h3",{attrs:{id:"connect-to-the-db-using-iam-role"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#connect-to-the-db-using-iam-role"}},[a._v("#")]),a._v(" Connect to the DB using IAM role")]),a._v(" "),t("p",[a._v("Try to connect to the MySQL database from Kubernetes pod using IAM role:")]),a._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://repost.aws/knowledge-center/users-connect-rds-iam",target:"_blank",rel:"noopener noreferrer"}},[a._v("How do I allow users to authenticate to an Amazon RDS MySQL DB instance using their IAM credentials?"),t("OutboundLink")],1)]),a._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/prometheus-community/postgres_exporter/issues/326",target:"_blank",rel:"noopener noreferrer"}},[a._v("AWS/EKS: Support for IAM authentication"),t("OutboundLink")],1)])]),a._v(" "),t("p",[a._v("Create Service Account "),t("code",[a._v("rds-sa")]),a._v(" for accessing the MySQL RDS DB :")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sed")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/  serviceAccounts:/a \\\n\\ \\ \\ \\ - metadata: '),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[a._v("\\n")]),a._v("\\\n        name: rds-sa "),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[a._v("\\n")]),a._v("\\\n        namespace: default "),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[a._v("\\n")]),a._v("\\\n      attachPolicy: "),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[a._v("\\n")]),a._v("\\\n        Version: 2012-10-17 "),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[a._v("\\n")]),a._v("\\\n        Statement: "),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[a._v("\\n")]),a._v("\\\n          Effect: Allow "),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[a._v("\\n")]),a._v("\\\n          Action: "),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[a._v("\\n")]),a._v("\\\n            - rds-db:connect "),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[a._v("\\n")]),a._v("\\\n          Resource: "),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[a._v("\\n")]),a._v("\\\n            - arn:aws:rds-db:"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${AWS_DEFAULT_REGION}")]),a._v(":*:dbuser:"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${RDS_DB_RESOURCE_ID}")]),a._v('/iamtest\n"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"tmp/'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${CLUSTER_FQDN}")]),a._v('/eksctl.yaml"')]),a._v("\n\neksctl create iamserviceaccount --config-file "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"tmp/'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${CLUSTER_FQDN}")]),a._v('/eksctl.yaml"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--approve")]),a._v("\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("kubectl apply "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" - "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('EOF\napiVersion: v1\nkind: Pod\nmetadata:\n  name: mysql-iam-test\nspec:\n  serviceAccountName: rds-sa\n  containers:\n  - name: ubuntu\n    image: ubuntu:20.04\n    command:\n      - /bin/bash\n      - -c\n      - |\n        set -x\n        apt update\n        apt install -y unzip less mysql-client wget telnet &> /dev/null\n        wget -q "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -O "awscliv2.zip"\n        unzip awscliv2.zip > /dev/null\n        ./aws/install\n        aws sts get-caller-identity\n        wget -q https://s3.amazonaws.com/rds-downloads/rds-ca-2019-root.pem\n        TOKEN="\\'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),a._v("aws rds generate-db-auth-token "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--hostname")]),a._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("RDS_DB_HOST"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--port")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3306")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--region")]),a._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("AWS_DEFAULT_REGION"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--username")]),a._v(" iamtest"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v('"\n        mysql -h "'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${RDS_DB_HOST}")]),a._v('" -u "iamtest" --password="'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${MY_PASSWORD}")]),a._v('" -e "show databases;"\n        mysql -h "'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${RDS_DB_HOST}")]),a._v('" -u "iamtest" --password="\\'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${TOKEN}")]),a._v('" --enable-cleartext-plugin --ssl-ca=rds-ca-2019-root.pem -e "show databases;"\n        mysql -h "'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${RDS_DB_HOST}")]),a._v('" -u "iamtest" --password="\\'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${TOKEN}")]),a._v('" --enable-cleartext-plugin --ssl-ca=amazon-root-CA-1.pem --ssl-mode=REQUIRED -e "show databases;"\n    resources:\n      requests:\n        memory: "64Mi"\n        cpu: "250m"\n      limits:\n        memory: "128Mi"\n        cpu: "500m"\n  restartPolicy: Never\nEOF')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sleep")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("50")]),a._v("\n")])])]),t("p",[a._v("Check the logs:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("kubectl logs mysql-iam-test "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--tail")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v("\n")])])]),t("p",[a._v("Output:")]),a._v(" "),t("div",{staticClass:"language-text extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("+ aws sts get-caller-identity\n{\n    \"UserId\": \"xxxxxxxxxxxxxxxxxxxxx:botocore-session-1638296138\",\n    \"Account\": \"7xxxxxxxxxx7\",\n    \"Arn\": \"arn:aws:sts::7xxxxxxxxxx7:assumed-role/eksctl-kube1-addon-iamserviceaccount-default-Role1-ZOKCKAOF74H0/botocore-session-1638296138\"\n}\n+ wget -q https://s3.amazonaws.com/rds-downloads/rds-ca-2019-root.pem\n++ aws rds generate-db-auth-token --hostname kube1db.cbpu7ikafk2a.eu-west-1.rds.amazonaws.com --port 3306 --region eu-west-1 --username iamtest\n+ TOKEN='kube1db.cbpu7ikafk2a.eu-west-1.rds.amazonaws.com:3306/?Action=connect&amp;DBUser=iamtest&amp;X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=xxxxxxxxxxxxxxxxxxxx%2F20211130%2Feu-west-1%2Frds-db%2Faws4_request&amp;X-Amz-Date=20211130T181540Z&amp;X-Amz-Expires=900&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Security-Token=IQo...6e917'\n+ mysql -h kube1db.cbpu7ikafk2a.eu-west-1.rds.amazonaws.com -u iamtest --password=MyAdmin123,. -e 'show databases;'\nmysql: [Warning] Using a password on the command line interface can be insecure.\nERROR 2059 (HY000): Authentication plugin 'mysql_clear_password' cannot be loaded: plugin not enabled\n+ mysql -h kube1db.cbpu7ikafk2a.eu-west-1.rds.amazonaws.com -u iamtest '--password=kube1db.cbpu7ikafk2a.eu-west-1.rds.amazonaws.com:3306/?Action=connect&amp;DBUser=iamtest&amp;X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=xxxxxxxxxxxxxxxxxxxx%2F20211130%2Feu-west-1%2Frds-db%2Faws4_request&amp;X-Amz-Date=20211130T181540Z&amp;X-Amz-Expires=900&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Security-Token=IQoJb3J...e917' --enable-cleartext-plugin --ssl-ca=rds-ca-2019-root.pem -e 'show databases;'\nmysql: [Warning] Using a password on the command line interface can be insecure.\nDatabase\niamtest\ninformation_schema\n+ mysql -h kube1db.cbpu7ikafk2a.eu-west-1.rds.amazonaws.com -u iamtest '--password=kube1db.cbpu7ikafk2a.eu-west-1.rds.amazonaws.com:3306/?Action=connect&amp;DBUser=iamtest&amp;X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=xxxxxxxxxxxxxxxxxxxx%2F20211130%2Feu-west-1%2Frds-db%2Faws4_request&amp;X-Amz-Date=20211130T181540Z&amp;X-Amz-Expires=900&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Security-Token=IQo...6e917' --enable-cleartext-plugin --ssl-ca=amazon-root-CA-1.pem --ssl-mode=REQUIRED -e 'show databases;'\nmysql: [Warning] Using a password on the command line interface can be insecure.\nWARNING: no verification of server certificate will be done. Use --ssl-mode=VERIFY_CA or VERIFY_IDENTITY.\nDatabase\niamtest\ninformation_schema\n")])])]),t("h3",{attrs:{id:"install-drupal"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install-drupal"}},[a._v("#")]),a._v(" Install Drupal")]),a._v(" "),t("p",[a._v("The variables containing "),t("code",[a._v("FileSystemId")]),a._v(" and "),t("code",[a._v("AccessPointId")]),a._v(" like\n"),t("code",[a._v("EFS_FS_ID_DRUPAL")]),a._v(" and "),t("code",[a._v("EFS_AP_ID_DRUPAL1")]),a._v("  were defined previously.")]),a._v(" "),t("p",[a._v("Create ReadWriteMany persistent volume like described "),t("a",{attrs:{href:"https://github.com/kubernetes-sigs/aws-efs-csi-driver/blob/master/examples/kubernetes/multiple_pods/README.md",target:"_blank",rel:"noopener noreferrer"}},[a._v("here"),t("OutboundLink")],1),a._v(":")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("kubectl get namespace drupal "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&>")]),a._v(" /dev/null "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("||")]),a._v(" kubectl create namespace drupal\nkubectl apply "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" - "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("EOF\napiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: efs-drupal-pv\nspec:\n  storageClassName: efs-drupal-static\n  capacity:\n    storage: 1Gi\n  volumeMode: Filesystem\n  accessModes:\n    - ReadWriteMany\n  persistentVolumeReclaimPolicy: Delete\n  csi:\n    driver: efs.csi.aws.com\n    volumeHandle: "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${EFS_FS_ID_DRUPAL}")]),a._v("::"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${EFS_AP_ID_DRUPAL1}")]),a._v("\n---\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: drupal-efs-pvc\n  namespace: drupal\nspec:\n  accessModes:\n    - ReadWriteMany\n  storageClassName: efs-drupal-static\n  volumeName: efs-drupal-pv\n  resources:\n    requests:\n      storage: 1Gi\nEOF")]),a._v("\n")])])]),t("p",[a._v("Install "),t("code",[a._v("drupal")]),a._v(" "),t("a",{attrs:{href:"https://artifacthub.io/packages/helm/bitnami/drupal",target:"_blank",rel:"noopener noreferrer"}},[a._v("helm chart"),t("OutboundLink")],1),a._v("\nand modify the\n"),t("a",{attrs:{href:"https://github.com/bitnami/charts/blob/master/bitnami/drupal/values.yaml",target:"_blank",rel:"noopener noreferrer"}},[a._v("default values"),t("OutboundLink")],1),a._v(".")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("helm repo "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),a._v(" --force-update bitnami https://charts.bitnami.com/bitnami\nhelm upgrade "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--install")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--version")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("10.2")]),a._v(".24 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--namespace")]),a._v(" drupal "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--values")]),a._v(" - drupal bitnami/drupal "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("EOF\nreplicaCount: 2\ndrupalUsername: admin\ndrupalPassword: "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${MY_PASSWORD}")]),a._v("\ndrupalEmail: "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${MY_EMAIL}")]),a._v("\nexternalDatabase:\n  host: "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${RDS_DB_HOST}")]),a._v("\n  user: drupal\n  password: "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${MY_PASSWORD}")]),a._v('\n  database: drupal\nsmtpHost: mailhog.mailhog.svc.cluster.local\nsmtpPort: 1025\nsmtpUser: "x"\nsmtpPassword: "x"\nmariadb:\n  enabled: false\nservice:\n  type: ClusterIP\ningress:\n  enabled: true\n  annotations:\n    nginx.ingress.kubernetes.io/auth-url: https://oauth2-proxy.'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${CLUSTER_FQDN}")]),a._v("/oauth2/auth\n    nginx.ingress.kubernetes.io/auth-signin: https://oauth2-proxy."),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${CLUSTER_FQDN}")]),a._v("/oauth2/start?rd=\\"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$scheme")]),a._v("://\\"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$host")]),a._v("\\"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$request_uri")]),a._v("\n  hostname: drupal."),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${CLUSTER_FQDN}")]),a._v("\n  tls:\n    - secretName: ingress-cert-"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${LETSENCRYPT_ENVIRONMENT}")]),a._v("\n      hosts:\n        - drupal."),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${CLUSTER_FQDN}")]),a._v("\npersistence:\n  enabled: true\n  # EFS dynamic provisioning can not be used due to UID/GID issue when EFS assign\n  # randomly GID to the NFS share and then Drupal can not write to it\n  # (chown to such directory is not working - prohibited by AWS)\n  # storageClass: efs-drupal\n  # accessMode: ReadWriteMany\n  # size: 1Gi\n  existingClaim: drupal-efs-pvc\nEOF")]),a._v("\n")])])]),t("h3",{attrs:{id:"install-drupal2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install-drupal2"}},[a._v("#")]),a._v(" Install Drupal2")]),a._v(" "),t("p",[a._v("The variables containing "),t("code",[a._v("FileSystemId")]),a._v(" and "),t("code",[a._v("AccessPointId")]),a._v(" like\n"),t("code",[a._v("EFS_FS_ID_DRUPAL")]),a._v(" and "),t("code",[a._v("EFS_AP_ID_DRUPAL2")]),a._v(" were defined previously.")]),a._v(" "),t("p",[a._v("Create ReadWriteMany persistent volume like described "),t("a",{attrs:{href:"https://github.com/kubernetes-sigs/aws-efs-csi-driver/blob/master/examples/kubernetes/multiple_pods/README.md",target:"_blank",rel:"noopener noreferrer"}},[a._v("here"),t("OutboundLink")],1),a._v(":")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("kubectl get namespace drupal2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&>")]),a._v(" /dev/null "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("||")]),a._v(" kubectl create namespace drupal2\nkubectl apply "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" - "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("EOF\napiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: efs-drupal2-pv\nspec:\n  storageClassName: efs-drupal-static\n  capacity:\n    storage: 1Gi\n  volumeMode: Filesystem\n  accessModes:\n    - ReadWriteMany\n  persistentVolumeReclaimPolicy: Delete\n  csi:\n    driver: efs.csi.aws.com\n    volumeHandle: "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${EFS_FS_ID_DRUPAL}")]),a._v("::"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${EFS_AP_ID_DRUPAL2}")]),a._v("\n---\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: drupal2-efs-pvc\n  namespace: drupal2\nspec:\n  accessModes:\n    - ReadWriteMany\n  storageClassName: efs-drupal-static\n  volumeName: efs-drupal2-pv\n  resources:\n    requests:\n      storage: 1Gi\nEOF")]),a._v("\n")])])]),t("p",[a._v("Enable Istio for namespace "),t("code",[a._v("drupal2")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("kubectl label namespace drupal2 istio-injection"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("enabled kiali.io/member-of"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("kiali "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--overwrite")]),a._v("\n")])])]),t("p",[a._v("Install "),t("code",[a._v("drupal2")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("helm upgrade "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--install")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--version")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("10.2")]),a._v(".24 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--namespace")]),a._v(" drupal2 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--values")]),a._v(" - drupal2 bitnami/drupal "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("EOF\nreplicaCount: 2\ndrupalUsername: admin\ndrupalPassword: "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${MY_PASSWORD}")]),a._v("\ndrupalEmail: "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${MY_EMAIL}")]),a._v('\ncommonLabels:\n  app: "{{ .Release.Name }}"\n  version: "{{ .Chart.AppVersion }}"\nexternalDatabase:\n  host: '),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${RDS_DB_HOST}")]),a._v("\n  user: drupal2\n  password: "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${MY_PASSWORD}")]),a._v('\n  database: drupal2\nsmtpHost: mailhog.mailhog.svc.cluster.local\nsmtpPort: 1025\nsmtpUser: "x"\nsmtpPassword: "x"\nmariadb:\n  enabled: false\nservice:\n  type: ClusterIP\npersistence:\n  enabled: true\n  existingClaim: drupal2-efs-pvc\nEOF')]),a._v("\n")])])]),t("p",[a._v("Create Istio components to allow accessing Drupal:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("kubectl apply "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" - "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("EOF\napiVersion: networking.istio.io/v1beta1\nkind: DestinationRule\nmetadata:\n  name: drupal-destination-rule\n  namespace: drupal2\nspec:\n  host: drupal2.drupal2.svc.cluster.local\n  trafficPolicy:\n    tls:\n      mode: DISABLE\n---\napiVersion: networking.istio.io/v1beta1\nkind: VirtualService\nmetadata:\n  name: drupal2-virtual-service\n  namespace: drupal2\nspec:\n  hosts:\n    - drupal2."),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${CLUSTER_FQDN}")]),a._v("\n  gateways:\n    - drupal2-gateway\n  http:\n    - route:\n        - destination:\n            host: drupal2.drupal2.svc.cluster.local\n            port:\n              number: 80\n---\napiVersion: networking.istio.io/v1beta1\nkind: Gateway\nmetadata:\n  name: drupal2-gateway\n  namespace: drupal2\nspec:\n  selector:\n    istio: ingressgateway\n  servers:\n    - port:\n        number: 443\n        name: https-drupal2\n        protocol: HTTPS\n      tls:\n        mode: SIMPLE\n        credentialName: ingress-cert-"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${LETSENCRYPT_ENVIRONMENT}")]),a._v("\n      hosts:\n        - drupal2."),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${CLUSTER_FQDN}")]),a._v("\nEOF")]),a._v("\n")])])]),t("p",[a._v("Generate traffic going to Drupal2:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("hey "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-n")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2000")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-q")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-h2")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"https://drupal2.'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${CLUSTER_FQDN}")]),a._v('"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" /dev/null "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v("\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);